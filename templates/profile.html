{% extends "base.html" %}

{% block title %}‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ - CodeFitKub{% endblock %}

{% block extra_head %}
<style>
    .nav-tabs {
        display: flex;
        gap: 10px;
        margin-bottom: 30px;
        flex-wrap: wrap;
    }
    .tab-btn {
        flex: 1;
        min-width: 150px;
        padding: 15px 25px;
        background: white;
        border: none;
        border-radius: 10px;
        font-size: 1.1em;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    .tab-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 12px rgba(0,0,0,0.15);
    }
    .tab-btn.active {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
    }
    .tab-content { display: none; }
    .tab-content.active { display: block; }
    .card {
        background: white;
        border-radius: 15px;
        padding: 30px;
        margin-bottom: 20px;
        box-shadow: 0 8px 25px rgba(0,0,0,0.15);
    }
    .form-group { margin-bottom: 20px; }
    label {
        display: block;
        margin-bottom: 8px;
        color: #333;
        font-weight: 600;
    }
    input, select, textarea {
        width: 100%;
        padding: 12px;
        border: 2px solid #e0e0e0;
        border-radius: 8px;
        font-size: 1em;
        transition: border-color 0.3s ease;
    }
    input:focus, select:focus, textarea:focus {
        outline: none;
        border-color: #667eea;
    }
    textarea {
        resize: vertical;
        min-height: 80px;
    }
    .btn {
        padding: 12px 30px;
        border: none;
        border-radius: 8px;
        font-size: 1.1em;
        cursor: pointer;
        transition: all 0.3s ease;
        margin-right: 10px;
    }
    .btn-primary {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
    }
    .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(102,126,234,0.4);
    }
    .btn-danger {
        background: #dc3545;
        color: white;
    }
    .btn-danger:hover { background: #c82333; }
    .item-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 20px;
        margin-top: 20px;
    }
    .item-card {
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        padding: 25px;
        border-radius: 12px;
        border-left: 5px solid #667eea;
        transition: all 0.3s ease;
    }
    .item-card:hover { 
        transform: translateX(5px);
        box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }
    .item-card h3 {
        color: #667eea;
        margin-bottom: 15px;
        font-size: 1.3em;
    }
    .item-card p {
        margin: 8px 0;
        color: #555;
        line-height: 1.6;
    }
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
    }
    .stat-card {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 25px;
        border-radius: 12px;
        text-align: center;
    }
    .stat-card h3 {
        font-size: 2.5em;
        margin-bottom: 10px;
    }
    .stat-card p {
        font-size: 1.1em;
        opacity: 0.9;
    }
    .log-item {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 10px;
        margin-bottom: 15px;
        border-left: 5px solid #28a745;
    }
    .log-item h4 {
        color: #667eea;
        margin-bottom: 10px;
    }
    .badge {
        display: inline-block;
        padding: 5px 12px;
        border-radius: 20px;
        font-size: 0.9em;
        margin: 3px;
        background: #667eea;
        color: white;
    }
    .empty-message {
        text-align: center;
        padding: 40px 20px;
        color: #999;
        font-size: 1.1em;
    }
    @media (max-width: 768px) {
        .nav-tabs { flex-direction: column; }
        .tab-btn { width: 100%; }
        .item-grid { grid-template-columns: 1fr; }
    }
</style>
{% endblock %}

{% block content %}
<h1>üí™ ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢</h1>
<p class="subtitle">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏° ‡∏ó‡πà‡∏≤‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢ ‡πÅ‡∏•‡∏∞‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢</p>

<div class="nav-tabs">
    <button class="tab-btn active" onclick="switchTab('programs')">üìã ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢</button>
    <button class="tab-btn" onclick="switchTab('exercises')">üèãÔ∏è ‡∏ó‡πà‡∏≤‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢</button>
    <button class="tab-btn" onclick="switchTab('history')">üìä ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á</button>
</div>

<!-- ‡πÅ‡∏ó‡πá‡∏ö‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢ -->
<div id="programs" class="tab-content active">
    <div class="card">
        <h2>‚ûï ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢</h2>
        <form id="programForm" onsubmit="addProgram(event)">
            <div class="form-group">
                <label>‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏° *</label>
                <input type="text" id="programName" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏•‡∏î‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å 30 ‡∏ß‡∏±‡∏ô">
            </div>
            <div class="form-group">
                <label>‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå</label>
                <select id="programGoal">
                    <option value="‡∏•‡∏î‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å">‡∏•‡∏î‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å</option>
                    <option value="‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏•‡πâ‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏•‡πâ‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠</option>
                    <option value="‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á">‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á</option>
                    <option value="‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏î‡∏ó‡∏ô">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏î‡∏ó‡∏ô</option>
                    <option value="‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô</option>
                </select>
            </div>
            <div class="form-group">
                <label>‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢</label>
                <textarea id="programDescription" placeholder="‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°..."></textarea>
            </div>
            <button type="submit" class="btn btn-primary">‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°</button>
        </form>
    </div>

    <div class="card">
        <h2>üìã ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h2>
        <div id="programList" class="item-grid"></div>
    </div>
</div>

<!-- ‡πÅ‡∏ó‡πá‡∏ö‡∏ó‡πà‡∏≤‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢ -->
<div id="exercises" class="tab-content">
    <div class="card">
        <h2>‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡πà‡∏≤‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡πÉ‡∏´‡∏°‡πà</h2>
        <form id="exerciseForm" onsubmit="addExercise(event)">
            <div class="form-group">
                <label>‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡πà‡∏≤‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢ *</label>
                <input type="text" id="exerciseName" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ß‡∏¥‡∏î‡∏û‡∏∑‡πâ‡∏ô, ‡∏™‡∏Ñ‡∏ß‡∏≠‡∏ï">
            </div>
            <div class="form-group">
                <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó *</label>
                <select id="exerciseType" required>
                    <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó --</option>
                    <option value="‡πÅ‡∏Ç‡∏ô">‡πÅ‡∏Ç‡∏ô</option>
                    <option value="‡∏Ç‡∏≤">‡∏Ç‡∏≤</option>
                    <option value="‡∏≠‡∏Å">‡∏≠‡∏Å</option>
                    <option value="‡∏´‡∏•‡∏±‡∏á">‡∏´‡∏•‡∏±‡∏á</option>
                    <option value="‡πÑ‡∏´‡∏•‡πà">‡πÑ‡∏´‡∏•‡πà</option>
                    <option value="‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡πâ‡∏≠‡∏á">‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡πâ‡∏≠‡∏á</option>
                    <option value="‡∏Ñ‡∏≤‡∏£‡πå‡∏î‡∏¥‡πÇ‡∏≠">‡∏Ñ‡∏≤‡∏£‡πå‡∏î‡∏¥‡πÇ‡∏≠</option>
                    <option value="‡∏¢‡∏∑‡∏î‡πÄ‡∏´‡∏¢‡∏µ‡∏¢‡∏î">‡∏¢‡∏∑‡∏î‡πÄ‡∏´‡∏¢‡∏µ‡∏¢‡∏î</option>
                </select>
            </div>
            <div class="form-group">
                <label>‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏Å *</label>
                <select id="exerciseDifficulty" required>
                    <option value="‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</option>
                    <option value="‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á">‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</option>
                    <option value="‡∏¢‡∏≤‡∏Å">‡∏¢‡∏≤‡∏Å</option>
                </select>
            </div>
            <div class="form-group">
                <label>‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢</label>
                <textarea id="exerciseDescription" placeholder="‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏ó‡πà‡∏≤‡∏ô‡∏µ‡πâ..."></textarea>
            </div>
            <button type="submit" class="btn btn-primary">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡πà‡∏≤‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢</button>
        </form>
    </div>

    <div class="card">
        <h2>üèãÔ∏è ‡∏ó‡πà‡∏≤‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h2>
        <div class="form-group">
            <label>‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</label>
            <select id="filterType" onchange="filterExercises()">
                <option value="">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                <option value="‡πÅ‡∏Ç‡∏ô">‡πÅ‡∏Ç‡∏ô</option>
                <option value="‡∏Ç‡∏≤">‡∏Ç‡∏≤</option>
                <option value="‡∏≠‡∏Å">‡∏≠‡∏Å</option>
                <option value="‡∏´‡∏•‡∏±‡∏á">‡∏´‡∏•‡∏±‡∏á</option>
                <option value="‡πÑ‡∏´‡∏•‡πà">‡πÑ‡∏´‡∏•‡πà</option>
                <option value="‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡πâ‡∏≠‡∏á">‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡πâ‡∏≠‡∏á</option>
                <option value="‡∏Ñ‡∏≤‡∏£‡πå‡∏î‡∏¥‡πÇ‡∏≠">‡∏Ñ‡∏≤‡∏£‡πå‡∏î‡∏¥‡πÇ‡∏≠</option>
                <option value="‡∏¢‡∏∑‡∏î‡πÄ‡∏´‡∏¢‡∏µ‡∏¢‡∏î">‡∏¢‡∏∑‡∏î‡πÄ‡∏´‡∏¢‡∏µ‡∏¢‡∏î</option>
            </select>
        </div>
        <div id="exerciseList" class="item-grid"></div>
    </div>
</div>

<!-- ‡πÅ‡∏ó‡πá‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥ -->
<div id="history" class="tab-content">
    <div id="statsContainer"></div>
    <div class="card">
        <h2>üìù ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢</h2>
        <div id="historyContainer"></div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
    let exercises = [];
    let programs = [];
    let workoutLogs = [];

    window.onload = function() {
        loadData();
        updateExerciseList();
        updateProgramList();
        showHistory();
    };

    function loadData() {
        // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å localStorage
        exercises = JSON.parse(localStorage.getItem('exercises') || '[]');
        programs = JSON.parse(localStorage.getItem('programs') || '[]');
        workoutLogs = JSON.parse(localStorage.getItem('workoutLogs') || '[]');

        // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
        if(exercises.length === 0) {
            exercises = [
                {id: 1, name: '‡∏ß‡∏¥‡∏î‡∏û‡∏∑‡πâ‡∏ô', type: '‡∏≠‡∏Å', difficulty: '‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô', description: '‡∏ß‡∏¥‡∏î‡∏û‡∏∑‡πâ‡∏ô‡πÅ‡∏ö‡∏ö‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô ‡πÄ‡∏ô‡πâ‡∏ô‡∏Å‡∏•‡πâ‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏≠‡∏Å'},
                {id: 2, name: '‡∏ã‡∏¥‡∏ó‡∏≠‡∏±‡∏û', type: '‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡πâ‡∏≠‡∏á', difficulty: '‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô', description: '‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏•‡πâ‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡πâ‡∏≠‡∏á'},
                {id: 3, name: '‡∏™‡∏Ñ‡∏ß‡∏≠‡∏ï', type: '‡∏Ç‡∏≤', difficulty: '‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á', description: '‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏•‡πâ‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏Ç‡∏≤‡πÅ‡∏•‡∏∞‡∏™‡∏∞‡πÇ‡∏û‡∏Å'},
                {id: 4, name: '‡∏ß‡∏¥‡πà‡∏á‡πÄ‡∏´‡∏¢‡∏≤‡∏∞', type: '‡∏Ñ‡∏≤‡∏£‡πå‡∏î‡∏¥‡πÇ‡∏≠', difficulty: '‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô', description: '‡∏ß‡∏¥‡πà‡∏á‡πÄ‡∏´‡∏¢‡∏≤‡∏∞‡∏ó‡∏µ‡πà‡∏à‡∏∏‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡πâ‡∏ô‡∏Ç‡∏≠‡∏á‡∏´‡∏±‡∏ß‡πÉ‡∏à'},
                {id: 5, name: '‡∏î‡∏±‡∏°‡πÄ‡∏ö‡∏•‡πÄ‡∏Ñ‡∏¥‡∏£‡πå‡∏•', type: '‡πÅ‡∏Ç‡∏ô', difficulty: '‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á', description: '‡∏¢‡∏Å‡∏Å‡∏•‡πâ‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠ biceps ‡∏î‡πâ‡∏ß‡∏¢‡∏î‡∏±‡∏°‡πÄ‡∏ö‡∏•'}
            ];
            localStorage.setItem('exercises', JSON.stringify(exercises));
        }

        if(programs.length === 0) {
            programs = [
                {id: 1, name: '‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏•‡∏î‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å', goal: '‡∏•‡∏î‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å', description: '‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏î‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å'},
                {id: 2, name: '‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏•‡πâ‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠', goal: '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏•‡πâ‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠', description: '‡πÄ‡∏ô‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏•‡πâ‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏ó‡∏±‡πà‡∏ß‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢'}
            ];
            localStorage.setItem('programs', JSON.stringify(programs));
        }
    }

    function switchTab(tabName) {
        document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
        document.getElementById(tabName).classList.add('active');
        event.target.classList.add('active');
        if(tabName === 'history') showHistory();
    }

    function addExercise(e) {
        e.preventDefault();
        const newExercise = {
            id: Date.now(),
            name: document.getElementById('exerciseName').value,
            type: document.getElementById('exerciseType').value,
            difficulty: document.getElementById('exerciseDifficulty').value,
            description: document.getElementById('exerciseDescription').value
        };
        exercises.push(newExercise);
        localStorage.setItem('exercises', JSON.stringify(exercises));
        updateExerciseList();
        document.getElementById('exerciseForm').reset();
        alert('‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡πà‡∏≤‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‚úÖ');
    }

    function updateExerciseList() {
        const filterType = document.getElementById('filterType')?.value || '';
        const filtered = filterType ? exercises.filter(ex => ex.type === filterType) : exercises;
        
        if(filtered.length === 0) {
            document.getElementById('exerciseList').innerHTML = '<div class="empty-message">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ó‡πà‡∏≤‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢</div>';
            return;
        }

        document.getElementById('exerciseList').innerHTML = filtered.map(ex => `
            <div class="item-card">
                <h3>üèãÔ∏è ${ex.name}</h3>
                <p><strong>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:</strong> <span class="badge">${ex.type}</span></p>
                <p><strong>‡∏£‡∏∞‡∏î‡∏±‡∏ö:</strong> <span class="badge">${ex.difficulty}</span></p>
                <p>${ex.description || '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢'}</p>
                <button class="btn btn-danger" style="margin-top: 10px;" onclick="deleteExercise(${ex.id})">üóëÔ∏è ‡∏•‡∏ö</button>
            </div>
        `).join('');
    }

    function filterExercises() { 
        updateExerciseList(); 
    }

    function deleteExercise(id) {
        if(confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏ó‡πà‡∏≤‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
            exercises = exercises.filter(ex => ex.id !== id);
            localStorage.setItem('exercises', JSON.stringify(exercises));
            updateExerciseList();
        }
    }

    function addProgram(e) {
        e.preventDefault();
        const newProgram = {
            id: Date.now(),
            name: document.getElementById('programName').value,
            goal: document.getElementById('programGoal').value,
            description: document.getElementById('programDescription').value
        };
        programs.push(newProgram);
        localStorage.setItem('programs', JSON.stringify(programs));
        updateProgramList();
        document.getElementById('programForm').reset();
        alert('‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‚úÖ');
    }

    function updateProgramList() {
        if(programs.length === 0) {
            document.getElementById('programList').innerHTML = '<div class="empty-message">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°</div>';
            return;
        }

        document.getElementById('programList').innerHTML = programs.map(p => `
            <div class="item-card">
                <h3>üìã ${p.name}</h3>
                <p><strong>‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå:</strong> <span class="badge">${p.goal}</span></p>
                <p>${p.description || '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢'}</p>
                <button class="btn btn-danger" style="margin-top: 10px;" onclick="deleteProgram(${p.id})">üóëÔ∏è ‡∏•‡∏ö</button>
            </div>
        `).join('');
    }

    function deleteProgram(id) {
        if(confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
            programs = programs.filter(p => p.id !== id);
            localStorage.setItem('programs', JSON.stringify(programs));
            updateProgramList();
        }
    }

    function showHistory() {
        workoutLogs = JSON.parse(localStorage.getItem('workoutLogs') || '[]');
        
        if(workoutLogs.length === 0) {
            document.getElementById('statsContainer').innerHTML = '';
            document.getElementById('historyContainer').innerHTML = '<div class="empty-message">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢<br>‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢</div>';
            return;
        }

        // ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥
        const totalWorkouts = workoutLogs.length;
        const exCount = {};
        workoutLogs.forEach(log => {
            exCount[log.exercise] = (exCount[log.exercise] || 0) + 1;
        });
        const mostPopular = Object.keys(exCount).length > 0 ? 
            Object.keys(exCount).reduce((a, b) => exCount[a] > exCount[b] ? a : b) : '-';
        
        const totalSets = workoutLogs.reduce((sum, log) => sum + parseInt(log.sets || 0), 0);
        const totalReps = workoutLogs.reduce((sum, log) => sum + parseInt(log.reps || 0), 0);

        document.getElementById('statsContainer').innerHTML = `
            <div class="stats-grid">
                <div class="stat-card"><h3>${totalWorkouts}</h3><p>‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p></div>
                <div class="stat-card"><h3>${totalSets}</h3><p>‡πÄ‡∏ã‡πá‡∏ï‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p></div>
                <div class="stat-card"><h3>${totalReps}</h3><p>‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p></div>
                <div class="stat-card"><h3 style="font-size: 1.3em;">${mostPopular}</h3><p>‡∏ó‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏ö‡πà‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</p></div>
            </div>
        `;

        // ‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥
        document.getElementById('historyContainer').innerHTML = workoutLogs
            .sort((a, b) => new Date(b.date) - new Date(a.date))
            .map(log => {
                const date = new Date(log.date);
                const details = [];
                if(log.sets > 0) details.push(`${log.sets} ‡πÄ‡∏ã‡πá‡∏ï`);
                if(log.reps > 0) details.push(`${log.reps} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á`);
                if(log.weight > 0) details.push(`${log.weight} kg`);
                
                return `
                    <div class="log-item">
                        <h4>üèãÔ∏è ${log.exercise}</h4>
                        <p><strong>üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</strong> ${date.toLocaleDateString('th-TH', {year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit'})}</p>
                        ${details.length > 0 ? `<p><strong>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î:</strong> ${details.join(' | ')}</p>` : ''}
                        ${log.note ? `<p><strong>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å:</strong> ${log.note}</p>` : ''}
                        <button class="btn btn-danger" style="margin-top: 10px;" onclick="deleteLog(${log.id})">üóëÔ∏è ‡∏•‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
                    </div>
                `;
            }).join('');
    }

    function deleteLog(id) {
        if(confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
            workoutLogs = workoutLogs.filter(l => l.id !== id);
            localStorage.setItem('workoutLogs', JSON.stringify(workoutLogs));
            showHistory();
            alert('‡∏•‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‚úÖ');
        }
    }
</script>
{% endblock %}